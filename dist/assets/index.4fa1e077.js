var J=Object.defineProperty;var ee=(r,e,t)=>e in r?J(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var d=(r,e,t)=>(ee(r,typeof e!="symbol"?e+"":e,t),t),te=(r,e,t)=>{if(!e.has(r))throw TypeError("Cannot "+t)};var $=(r,e,t)=>(te(r,e,"read from private field"),t?t.call(r):e.get(r)),V=(r,e,t)=>{if(e.has(r))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(r):e.set(r,t)};import{H as ie,M as ne,V as M,S as W,D as U,C as D,P as oe,A as b,B as H,a as se,b as G,T as ae,c as le,R as re,d as Z,e as _,W as he,E as ce,f as de,U as me,g as ge,h as fe}from"./vendor.cfdefcf0.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function t(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerpolicy&&(n.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?n.credentials="include":i.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(i){if(i.ep)return;i.ep=!0;const n=t(i);fetch(i.href,n)}})();window.exports=window;class ue{constructor(e,t,o,i=0){d(this,"complete",!1);d(this,"title");d(this,"description");d(this,"failed",!1);d(this,"onFail");d(this,"onSuccess");d(this,"onCompletion");d(this,"currentState");d(this,"tasks");d(this,"resetSOP",()=>{this.currentState=0,this.failed=!1,this.complete=!1});this.title=e,this.description=t,this.tasks=o,this.currentState=i}}const I=60,pe=50,Y=3,y="cylinder",F="liquid",be="placard",A=new ue("","",[{next:"CtoA",label:"BtoC"},{next:"complete",label:"CtoA"}]);function p(r,e){return r.getChildMeshes().find(t=>t.name===e)||null}function w(r){r.rotation.x=0,r.rotation.y=0,r.rotation.z=0}function q(r){r.position.x=0,r.position.y=0,r.position.z=0}class R{constructor(e,t,o,i){d(this,"name");d(this,"position");d(this,"mesh");d(this,"dragCollision");d(this,"highlightLayer");d(this,"scene");console.log(e),this.name=o;const n=e.getScene();this.scene=n,this.highlightLayer=new ie("highlight-layer",n),this.highlightLayer.innerGlow=!0,this.highlightLayer.outerGlow=!1;const c=n.getMeshByName("Table");let s=ne.CreateSphere(`pivot-Cylinder-${o}`,{segments:2,diameterX:.15,diameterY:.33,diameterZ:.2},e.getScene());if(s.visibility=0,e.name=o,e.parent=s,e.rotationQuaternion=null,e.getChildMeshes().forEach(f=>{switch(f.name){case"BeakerwOpacity":f.name=y,f.rotationQuaternion=null,f.rotation.z=2*Math.PI,f.isPickable=!1;break;case"BeakerLiquid":f.name=F,f.isPickable=!1;break}}),c){const f=c.getBoundingInfo().boundingBox,B=p(e,y).getBoundingInfo().boundingBox.maximum.y+1e-8;s.position.y=f.maximumWorld.y+B,s.position.x=(f.maximumWorld.x-f.minimumWorld.x)/Y*t+f.minimumWorld.x-.3,s.position.z=(f.centerWorld.z+f.minimumWorld.z)/2,this.position={...s.position}}else s.position.x=-2+t,s.position.y=1.22,s.position.z=.5;s.checkCollisions=!0,s.ellipsoid=new M(.02,.16,.02),this.mesh=s;const l=p(e,F),u=new W("liquid-material");u.diffuseColor=i,l.material=u;const m=p(e,"Label"),h=p(e,"LabelBack");console.log("Label:",h);const g=new U("dynamic texture",256,n),a=new W("Mat",n);a.diffuseTexture=g,m.material=a,h.material=a;const x="bold 300px monospace";g.drawText(e.name.toUpperCase(),65,225,x,"black","white");let L=this.mesh.getChildMeshes().find(f=>f.name==="cylinder");this.mesh.animations=L.animations,console.log("Children: ",this.mesh.getChildMeshes()),this.addDragCollision()}highlight(e=!0){let t=p(this.mesh,y);e?(console.log("Adding mesh"),this.highlightLayer.hasMesh(t)||this.highlightLayer.addMesh(t,D.Green())):this.highlightLayer.hasMesh(t)&&this.highlightLayer.removeMesh(t)}addDragCollision(){let e=new oe({dragPlaneNormal:new M(0,0,1)});e.useObjectOrientationForDragging=!1,e.moveAttached=!1,e.onDragStartObservable.add(()=>{}),e.onDragObservable.add(t=>{this.mesh.moveWithCollisions(t.delta)}),e.onDragEndObservable.add(()=>{this.fadeAndRespawn()}),this.mesh.addBehavior(e),this.dragCollision=e}removeDragCollision(){this.mesh.removeBehavior(this.dragCollision)}fadeAndRespawn(e=pe){setTimeout(()=>{this.mesh.isPickable=!1;let t=60;this.mesh.name.split("-")[0];let o=this.mesh.getScene(),i=this.mesh.getChildMeshes(),n=i.find(s=>s.name==="cylinder");i.find(s=>s.name==="liquid");let c=[{name:"Invisibility",startValue:1},{name:"Visibility",startValue:0}];c.forEach(s=>{s.init=new b(s.name,"visibility",120,b.ANIMATIONTYPE_FLOAT,b.ANIMATIONLOOPMODE_CONSTANT),s.init.setKeys([{frame:0,value:s.startValue},{frame:t,value:1-s.startValue}])});for(let s=0;s<i.length-1;++s){let l=i[s];o.beginDirectAnimation(l,[c[0].init],0,60,!1)}o.beginDirectAnimation(i[i.length-1],[c[0].init],0,60,!1,void 0,()=>{console.log(this.mesh,this.position),this.mesh.position.x=this.position._x,this.mesh.position.y=this.position._y,this.mesh.position.z=this.position._z,this.mesh.animations=n.animations;let s=p(this.mesh,y);w(this.mesh),w(s),q(s);for(let l=0;l<i.length-1;++l){let u=i[l];o.beginDirectAnimation(u,[c[1].init],0,60,!1)}o.beginDirectAnimation(i[i.length-1],[c[1].init],0,60,!1,void 0,()=>{this.highlight(!1),this.mesh.isPickable=!0})})},e)}rotateAroundZ(){let e=this.mesh.getAnimationByName(`${this.name}-rotateAroundZ`);this.scene.beginDirectAnimation(p(this.mesh,y),[e],0,60,!1,void 0,()=>{})}resetAroundZ(){let e=this.mesh.getAnimationByName(`${this.name}-resetRotateAroundZ`);this.scene.beginDirectAnimation(p(this.mesh,y),[e],0,60,!1,void 0,()=>{})}}function ye(r){r.name="clipboard";const e=r.getScene(),t=e.getMeshByName("Table");if(t){const i=t.getBoundingInfo().boundingBox;r.position.y=i.maximumWorld.y+.003}r.rotationQuaternion=null,r.rotation=new M(0,Math.PI/4,0);const o=e.getMeshByName("pivot-Cylinder-A");o&&(r.position.x=o.position.x+.2,r.position.z=o.position.z+.5)}function Me(r){var e=new H(D.FromHexString("#0984e3"));e.ignoreChildren=!0;var t=r[0],o=H.MakeNotPickableAndWrapInBoundingBox(t);e.attachedMesh=o,e.onScaleBoxDragObservable.add(()=>{console.log("scaleDrag")}),e.onScaleBoxDragEndObservable.add(()=>{const i=e.attachedMesh;if(i){const n=i.getHierarchyBoundingVectors(!0);console.log("size x:",n.max.x-n.min.x),console.log("size y:",n.max.y-n.min.y),console.log("size z:",n.max.z-n.min.z)}console.log("scaleEnd")}),e.onRotationSphereDragObservable.add(()=>{console.log("rotDrag")}),e.onRotationSphereDragEndObservable.add(()=>{console.log("rotEnd")})}function z(r,e,t){const o=r.find(h=>h.name==="__root__"),i=o.getScene();o.name=t;const n=r.find(h=>h.name==="Label"),c=r.find(h=>h.name==="Placard");c.name=be;const s=new U("dynamic texture",256,i);s.wAng=-Math.PI/2,s.uAng=Math.PI;const l=new W("Mat",i);l.diffuseTexture=s,n.material=l;const u="bold 220px monospace";s.drawText(o.name.split("-")[1].toUpperCase(),65,185,u,"black","white"),c.addChild(n),c.rotationQuaternion=null,c.rotation=new M(0,Math.PI/2,0);const m=i.getMeshByName("Table");if(m){const h=m.getBoundingInfo().boundingBox;o.position.y=h.maximumWorld.y+.003,o.position.x=(h.maximumWorld.x-h.minimumWorld.x)/Y*e+h.minimumWorld.x-.2,o.position.z=(h.centerWorld.z+h.minimumWorld.z)/2+.2}}function Ae(r,e,t){let o;return new Promise(i=>{const n="./models/";let c="";var s={};let l=["left","right"];const u=new se(r);l.forEach(h=>{u.addMeshTask(`load ${h} hand`,"",n,`${h}${c}.glb`)});let m=0;u.onTaskSuccess=h=>{s[l[m]]=h.loadedMeshes[1],h.loadedMeshes[1].name=l[m],o=h.loadedAnimationGroups;for(let g=0;g<o.length;g++)o[g].name=`${l[m]}_${o[g].name}`;m++},u.onTasksDoneObservable.add(()=>{for(let h=0;h<r.animationGroups.length;h++)r.animationGroups[h].pause();e.input.onControllerAddedObservable.add(h=>{let g=h.inputSource.handedness;console.log(s[g]);let a=s[g].parent.parent;s[g].isPickable=!1;for(let S of t)S.removeDragCollision();let x=(Object.keys(s).indexOf(g)-1)*2-1;s[g].rotation.y=Math.PI*x,s[g].rotation.z=0,s[g].rotation.x=-Math.PI/4,a.parent=h.grip||h.pointer})}),u.loadAsync().then(()=>{i(o)})})}class Ce{constructor(e,t){d(this,"cylinderInstances");d(this,"clipboard");d(this,"scene");d(this,"labels");this.labels=["A","B","C"],this.scene=e,this.cylinderInstances=t}intersectHandCylinder(e){for(let t of this.labels){let o=this.scene.getMeshByName(`pivot-Cylinder-${t}`);if(e.intersectsMesh(o,!1))return o}return null}intersectCylinder(e){for(let t of this.labels){let o=this.scene.getMeshByName(`pivot-Cylinder-${t}`);if(o!=e&&e.intersectsMesh(o))return o}return!1}highlightAndRotateCylinders(e,t,o){e.highlight(),t.highlight();let i=e.mesh.getAbsolutePosition()._x,n=t.mesh.getAbsolutePosition()._x;if(n<i?(console.log("Left hit!"),e.mesh.rotation.y=Math.PI,t.mesh.rotation.y=e.mesh.rotation.y):(console.log("Right hit!"),e.mesh.rotation.y=0,t.mesh.rotation.y=e.mesh.rotation.y),!o){o=!0;let c=e.mesh.getHierarchyBoundingVectors(),s=c.max.y-c.min.y,l=-.09,m=i-n,h=p(e.mesh,y);n<i?(console.log("Src pos: ",e.position.x),h.position.x=m+l,h.position.y=s-.2):(h.position.x=m-l,h.position.y=s-.2),e.rotateAroundZ()}return o}moveWithCollisions(e,t){e.moveWithCollisions(t)}}class j{constructor(e,t){d(this,"scene");d(this,"sop");this.scene=e,this.sop=t,console.log(e)}resetCylinders(){console.log(this);let e=["A","B","C"];for(let t=0;t<e.length;t++){const o=this.scene.getMeshByName(`pivot-Cylinder-${e[t]}`),i=this.scene.getMeshByName("Table");if(i&&o){const n=i.getBoundingInfo().boundingBox;o.position.z=(n.centerWorld.z+n.minimumWorld.z)/2}}}postSceneCylinder(){this.resetCylinders();let e=["A","B","C"],t=[];for(let i of e){const n=this.scene.getMeshByName(`pivot-Cylinder-${i}`);t.push(n);let c=new b(`${i}-rotateAroundZ`,"rotation.z",120,b.ANIMATIONTYPE_FLOAT,b.ANIMATIONLOOPMODE_CONSTANT),s=p(n,y);const l=[];l.push({frame:0,value:Math.PI*2}),l.push({frame:60,value:4.62}),s.animations.push(c),c.setKeys(l);let u=new b(`${i}-resetRotateAroundZ`,"rotation.z",120,b.ANIMATIONTYPE_FLOAT,b.ANIMATIONLOOPMODE_CONSTANT);const m=[];m.push({frame:0,value:4.62}),m.push({frame:60,value:Math.PI*2}),s.animations.push(u),u.setKeys(m)}let o=!1;for(let i=0;i<e.length;i++){const n=this.scene.getMeshByName(`pivot-Cylinder-${e[i]}`),c=n.getBehaviorByName("PointerDrag");let s=[];for(let m of t)m!=n&&s.push(m);let l=p(n,y),u=!1;c.onDragObservable.add(()=>{const m=p(n,y).getBehaviorByName("Highlight");let h=!1;for(let g=0;g<e.length;g++){if(i==g)continue;const a=this.scene.getMeshByName(`pivot-Cylinder-${e[g]}`);if(w(n),w(a),n.intersectsMesh(a)){h=!0;let x=a.name.split("-")[2],L=`${n.name.split("-")[2]}to${x}`;if(this.sop.tasks[this.sop.currentState].label===L)console.log("WHAT??"),this.sop.tasks[this.sop.currentState].next==="complete"?window.location.assign("."):this.sop.currentState=this.sop.tasks.indexOf(this.sop.tasks.find(f=>f.label==this.sop.tasks[this.sop.currentState].next));else if(!o){o=!0;const f=new G("particles",500,this.scene);f.particleTexture=new ae("https://raw.githubusercontent.com/PatrickRyanMS/BabylonJStextures/master/FFV/smokeParticleTexture.png",this.scene),f.minLifeTime=.5,f.maxLifeTime=.7,f.emitRate=100,f.gravity=new M(0,.5,0),f.minSize=.01,f.maxSize=.07,f.createPointEmitter(new M(0,0,0),new M(0,1,0));const C=p(a,F);f.addColorGradient(1,le.FromColor3(C.material.diffuseColor,1)),f.blendMode=G.BLENDMODE_STANDARD,f.emitter=a.position,f.start()}if(m){let f=p(a,y);m.highlightMesh(l),m.highlightMesh(f);let C=n.getAbsolutePosition()._x,P=a.getAbsolutePosition()._x;if(P<C?(l.rotation.y=Math.PI,a.rotation.y=l.rotation.y):(l.rotation.y=0,a.rotation.y=l.rotation.y),!u){let B=n.getHierarchyBoundingVectors(),v=B.max.y-B.min.y,N=-.09,T=C-P;P<C?(console.log("Src pos: ",l.position.x),l.position.x=T+N,l.position.y=v-.2):(l.position.x=T-N,l.position.y=v-.2),console.log("Y size: ",v);let O=l.getAnimationByName(`${e[i]}-rotateAroundZ`);u=!0,this.scene.beginDirectAnimation(l,[O],0,60,!1,void 0,()=>{})}}break}else m.unhighlightMesh(p(a,y)),w(a),w(n)}if(h==!1){m.unhighlightMesh(l);let g=l.getAnimationByName(`${e[i]}-resetRotateAroundZ`);u&&(l.position.x=0,l.position.y=0,u=!1,console.log(l,g,`${e[i]}-resetRotateAroundZ`),this.scene.beginDirectAnimation(l,[g],0,60,!1,void 0,()=>{}))}}),c.onDragEndObservable.add(()=>{const m=p(n,y).getBehaviorByName("Highlight");for(let h of s){if(h==l)continue;let g=p(h,y);if(m.unhighlightMesh(l),m.unhighlightMesh(g),l.intersectsMesh(h)){let a=l.getAnimationByName(`${e[i]}-resetRotateAroundZ`);l.rotation.z==4.62&&this.scene.beginDirectAnimation(l,[a],0,60,!1,void 0,()=>{})}}})}}}class K extends Ce{constructor(t,o,i){super(o,i);d(this,"handedness");d(this,"holdingInstance");d(this,"holdingMesh");d(this,"targetMesh");d(this,"targetMeshInstance");d(this,"motionController");d(this,"handMesh");d(this,"isVisible");this.handedness=t,this.handMesh=o.getMeshByName(this.handedness),this.isVisible=!0}getMotionController(){return this.motionController}setMotionController(t){this.motionController=t}dropped(t){this.motionController.lastPosition=null,clearInterval(t),this.motionController.grabbed=!1,this.motionController.meshGrabbed=void 0,console.log(this.holdingMesh),this.holdingMesh&&(this.holdingInstance.fadeAndRespawn(100),this.holdingMesh=null,this.holdingInstance=null,this.motionController.meshGrabbed=null)}updateSOPTask(t,o,i){console.log(this.scene);let n=`${t}to${o}`;if(A.tasks[A.currentState].label===n)if(A.tasks[A.currentState].next==="complete"){let c=new j(this.scene,A);for(let s of this.cylinderInstances)s.fadeAndRespawn(100);return this.disappearAnimation(!1),this.dropped(i),c.resetCylinders(),A.resetSOP(),!0}else return A.currentState=A.tasks.indexOf(A.tasks.find(c=>c.label==A.tasks[A.currentState].next)),!1}disappearAnimation(t=!0){console.log("DISAPPEAR: ",t);let o=30,i=[{name:"Invisibility",startValue:1},{name:"Visibility",startValue:0}];i.forEach(n=>{n.init=new b(n.name,"visibility",120,b.ANIMATIONTYPE_FLOAT,b.ANIMATIONLOOPMODE_CONSTANT),n.init.setKeys([{frame:0,value:n.startValue},{frame:o,value:1-n.startValue}])}),console.log(this.handMesh),t?(this.isVisible=!1,this.scene.beginDirectAnimation(this.handMesh,[i[0].init],0,o,!1)):(this.isVisible=!0,this.scene.beginDirectAnimation(this.handMesh,[i[1].init],0,o,!1))}}function xe(r,e,t,o){let i=new K("right",r,o),n=new K("left",r,o),c=!1,s={right:i,left:n},l=!1;function u(m){let h=m.name.split("-")[2];console.log("Name: ",h);for(let g of o)if(console.log("Instance name: ",g.name),g.name==h)return g;return null}e.input.onControllerAddedObservable.add(m=>{m.onMotionControllerInitObservable.add(h=>{let g=h;g.handID=h.handedness;let a=s[g.handedness];a.getMotionController()||a.setMotionController(g),console.log(a);let x=new re(M.Zero(),M.Zero(),.25);const S=h.getComponentOfType("squeeze");h.getComponentOfType("trigger"),[S].forEach(L=>{console.log(r.getMeshByName("left")),L.onButtonStateChangedObservable.add(f=>{let C,P={left:"Fist",right:"Grip"},B=r.animationGroups.find((N,k)=>N.name===`${a.motionController.handID}_${P[a.motionController.handID]}`);B.goToFrame(f.value*(B._to-1)+1);let v=a.intersectHandCylinder(r.getMeshByName(g.handID));if(console.log("Grabbed Cylinder: ",v),f.value>0&&!a.motionController.grabbed){if(v){c=!1,a.holdingMesh=v,a.holdingInstance=u(a.holdingMesh),a.motionController.meshGrabbed=a.holdingMesh,a.motionController.grabbed=!0;let N=a.motionController.lastPosition,k=x.origin;k!=N&&(a.disappearAnimation(!0),C=setInterval(()=>{let T=a.motionController.lastPosition;if(m.getWorldPointerRayToRef(x),T&&a.holdingMesh&&a.moveWithCollisions(a.holdingMesh,k.subtract(T)),!a.intersectHandCylinder(r.getMeshByName(a.motionController.handID))&&a.holdingMesh&&(a.targetMeshInstance&&a.targetMeshInstance.highlight(!1),a.dropped(C),a.motionController.grabbed=!1,a.handMesh.visibility=1,c=!0),a.holdingMesh){let O=a.intersectCylinder(a.holdingMesh);if(O){a.targetMesh=O,a.targetMeshInstance=u(O);let X=O.name.split("-")[2],Q=a.holdingMesh.name.split("-")[2];l=a.highlightAndRotateCylinders(a.holdingInstance,a.targetMeshInstance,l),c=a.updateSOPTask(Q,X,C)}else a.targetMeshInstance&&a.targetMeshInstance.highlight(!1),a.holdingInstance.highlight(!1),l&&(a.holdingInstance.resetAroundZ(),q(p(a.holdingMesh,y)),l=!1)}c||(a.motionController.lastPosition=Object.assign({},x.origin),g.lastPosition=Object.assign({},x.origin))},10))}}else(!f.value||!v)&&a.holdingMesh&&(a.holdingInstance.highlight(!1),a.motionController.grabbed=!1,a.targetMeshInstance&&a.targetMeshInstance.highlight(!1),a.dropped(C),a.disappearAnimation(!1))})})})})}var E;class ve{constructor(e){d(this,"flying",!1);d(this,"active",!1);d(this,"camera");d(this,"mesh");d(this,"offset",.3);d(this,"animations");d(this,"returnPosition");d(this,"returnRotation");d(this,"onPointerDownObserver");d(this,"xrCamera");d(this,"attach",(e,t,o,i,n)=>{const c=e.getScene();if(this.mesh=e,!t&&(t=c.activeCamera,!t))throw new Error("The scene has no active camera, and no camera was provided.");this.camera=t,o||(o=this.mesh.position),i||(i=this.mesh.rotation),n&&(this.offset=n),this.returnPosition=o,this.returnRotation=i,this.onPointerDownObserver=c.onPointerObservable.add(this.clipboardClick)});d(this,"detach",()=>{this.mesh.getScene().onPointerObservable.remove(this.onPointerDownObserver)});d(this,"clipboardClick",(e={type:Z.POINTERDOWN,pickInfo:{pickedMesh:this.mesh}})=>{var t;if(e.type===Z.POINTERDOWN){console.log("Clipboard click");const o=(t=e.pickInfo)==null?void 0:t.pickedMesh;if(o&&(o===this.mesh||o.isDescendantOf(this.mesh))&&!this.flying||this.active){const i=this.active?I/2:0,n=this.active?0:I/2;$(this,E).call(this),this.flying=!0,this.mesh.billboardMode==_.BILLBOARDMODE_ALL?this.mesh.billboardMode=_.BILLBOARDMODE_NONE:this.mesh.billboardMode=_.BILLBOARDMODE_ALL,this.mesh.getScene().beginDirectAnimation(this.mesh,this.animations,i,n,!1,void 0,()=>{this.flying=!1,this.active=!this.active})}}});d(this,"calculateTargetPositionWithOffset",e=>{if(this.xrCamera!==void 0&&this.xrCamera.state===he.IN_XR){const c=this.xrCamera.camera._position.subtract(this.returnPosition).scale(1-e/M.Distance(this.returnPosition,this.xrCamera.camera._position));return this.returnPosition.add(c)}const o=this.camera._position.subtract(this.returnPosition).scale(1-e/M.Distance(this.returnPosition,this.camera._position));return this.returnPosition.add(o)});d(this,"setClipboardUp",()=>new M(3.1468286,4.6617744,1.680752));V(this,E,()=>{const e=this.animations.find(({name:n})=>n==="translate"),t=this.animations.find(({name:n})=>n==="rotate"),o=[{frame:0,value:this.returnPosition},{frame:I/2,value:this.calculateTargetPositionWithOffset(this.offset)}],i=[{frame:0,value:this.returnRotation},{frame:I/2,value:this.setClipboardUp()}];e.setKeys(o),t.setKeys(i)});const t=new b("translate","position",I,b.ANIMATIONTYPE_VECTOR3),o=new b("rotate","rotation",I,b.ANIMATIONTYPE_VECTOR3);this.animations=[t,o],this.xrCamera=e}get name(){return"FlyToCamera"}init(){}}E=new WeakMap;console.log=()=>{};class Be{constructor(){d(this,"handAnimation");d(this,"sop");d(this,"models");d(this,"cylinders");this.cylinders=[];let e="TLLGraduatedCylinderNewLabel.glb";this.models=[{fileName:"NewLaboratoryUNFINISHED.glb",callback:t=>this.createRoom(t),label:"floor"},{fileName:"clipBoardWithPaperCompressedTexture.glb",callback:t=>ye(t[0])},{fileName:"Placard_Label.glb",callback:t=>z(t,1,"Placard-A")},{fileName:"Placard_Label.glb",callback:t=>z(t,2,"Placard-B")},{fileName:"Placard_Label.glb",callback:t=>z(t,3,"Placard-C")},{fileName:e,callback:t=>this.cylinders.push(new R(t[0],1,"A",new D(1,0,0))),label:"Cylinder-A"},{fileName:e,callback:t=>this.cylinders.push(new R(t[0],2,"B",new D(0,1,0))),label:"Cylinder-B"},{fileName:e,callback:t=>this.cylinders.push(new R(t[0],3,"C",new D(0,0,1))),label:"Cylinder-C"}].map(function(t){return Object.assign({},{fileName:"LabBench.glb",root:"./models/",callback:Me,label:"NoLabel"},t)}),this.createScene().then(t=>{for(let o of["A","B","C"])Object.assign({},t.getMeshByName(`pivot-Cylinder-${o}`).position);this.processScene(t,this.cylinders)})}async processScene(e,t){let o=e.getCameraByName("camera"),i=e.getLightByName("light1"),n;o.speed=.16;let c=setInterval(()=>{i.intensity>=1?clearInterval(c):i.intensity+=.1},60);const s=["WallsandFloor","WallsAndFloor.001"],l=[];for(let m of s){console.log(m);const h=e.getMeshByName(m);h&&l.push(h)}let u={floorMeshes:l,inputOptions:{doNotLoadControllerMeshes:!0}};n=await e.createDefaultXRExperienceAsync(u),n.pointerSelection.displayLaserPointer=!1,n.pointerSelection.displaySelectionMesh=!1,Ae(e,n,t).then(m=>{if(console.log("add webxr"),n){const g=new ve(n.baseExperience);e.getMeshByName("clipboard").addBehavior(g)}new j(e,A).postSceneCylinder(),xe(e,n,m,t)})}createRoom(e){const t=["WallsandFloor","WallsAndFloor.001","Table","Roof","Countertop","Walls"];let o,i;for(let n of t){const c=e.find(s=>s.name===n);if(c&&(c.checkCollisions=!0,c.name==="Table")){const l=c.getBoundingInfo().boundingBox.center.x;o=c.getScene(),i=o.getCameraByName("camera"),i.position.x=l-.7}}}createScene(){return new Promise(e=>{const t=document.getElementById("canvas"),o=new ce(t,!0,{stencil:!0}),i=new de(o);i.collisionsEnabled=!0,window.addEventListener("resize",function(){o.resize()});const n=new me("camera",new M(0,1.84,-1.134),i);n.ellipsoid=new M(.4,.7,.4),n.attachControl(t,!0),n.applyGravity=!0,n.minZ=0,n.speed=0,n.checkCollisions=!0,n.keysUp.push(87),n.keysDown.push(83),n.keysLeft.push(65),n.keysRight.push(68);var c=new ge("light1",new M(1,1,0),i);c.intensity=0,Promise.all(this.models.map(s=>new Promise(l=>fe.ImportMesh("",s.root,s.fileName,i,function(u){s.mesh=u,l(u)})))).then(()=>{let s=[];this.models.map(l=>{s.push(l.callback(l.mesh)),e(i)})}),window.addEventListener("keydown",s=>{s.shiftKey&&s.ctrlKey&&s.altKey&&s.keyCode===73&&(i.debugLayer.isVisible()?i.debugLayer.hide():i.debugLayer.show())}),o.runRenderLoop(()=>{i.render()})})}}new Be;
